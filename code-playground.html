<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Knowledge Quiz - Hippocamp Academy</title>
    <meta name="theme-color" content="#FFC9D4">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="home-enhanced.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        .quiz-hero {
            background: linear-gradient(135deg, rgba(255, 201, 212, 0.2) 0%, rgba(255, 175, 191, 0.2) 50%, rgba(255, 143, 163, 0.2) 100%);
            background-size: 200% 200%;
            animation: gradientShift 15s ease infinite;
            padding: 100px 20px 80px;
            text-align: center;
            color: white;
            margin-bottom: 60px;
            position: relative;
            overflow: hidden;
        }

        .quiz-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
            z-index: -1;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .quiz-hero h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            margin: 0 0 20px 0;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-light), var(--primary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .quiz-hero p {
            font-size: 1.4em;
            opacity: 0.95;
            margin: 0;
            color: rgba(255, 255, 255, 0.9);
        }

        .quiz-container {
            max-width: 900px;
            margin: 0 auto 80px;
            padding: 0 20px;
        }

        .quiz-progress {
            background: rgba(255, 201, 212, 0.08);
            border: 2px solid rgba(255, 201, 212, 0.2);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 40px;
            text-align: center;
        }

        .progress-text {
            font-size: 1.3em;
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 15px;
        }

        .progress-bar-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
            height: 100%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .quiz-card {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 201, 212, 0.2);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .difficulty-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .difficulty-easy {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.4);
        }

        .difficulty-medium {
            background: rgba(255, 201, 212, 0.2);
            color: var(--primary-color);
            border: 1px solid rgba(255, 201, 212, 0.4);
        }

        .difficulty-hard {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.4);
        }

        .quiz-question {
            font-size: 1.6em;
            font-weight: 700;
            color: white;
            margin: 0 0 30px 0;
            line-height: 1.5;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .quiz-option {
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px 25px;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .quiz-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 201, 212, 0.5);
            transform: translateX(10px);
        }

        .quiz-option.selected {
            background: rgba(255, 201, 212, 0.15);
            border-color: var(--primary-color);
        }

        .quiz-option.correct {
            background: rgba(34, 197, 94, 0.2);
            border-color: #22c55e;
            animation: correctPulse 0.5s ease;
        }

        .quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.2);
            border-color: #ef4444;
            animation: shake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .quiz-explanation {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 201, 212, 0.1);
            border-left: 4px solid var(--primary-color);
            border-radius: 8px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 1em;
            line-height: 1.7;
        }

        .quiz-explanation.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .quiz-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        .btn-quiz {
            padding: 15px 40px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-next {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
        }

        .btn-next:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 201, 212, 0.5);
        }

        .btn-next:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Results Screen */
        .results-screen {
            display: none;
            text-align: center;
            padding: 60px 20px;
        }

        .results-screen.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .results-title {
            font-size: 3em;
            margin: 0 0 20px 0;
            color: white;
        }

        .score-display {
            font-size: clamp(4rem, 10vw, 8rem);
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-light), var(--primary-dark), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 30px 0;
            line-height: 1;
            perspective: 1000px;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
            cursor: default;
        }

        .score-display:hover {
            transform: scale(1.05);
        }

        .score-message {
            font-size: 1.8em;
            color: rgba(255, 255, 255, 0.9);
            margin: 30px 0;
            font-weight: 600;
        }

        .badge-container {
            margin: 40px 0;
            padding: 40px;
            background: rgba(255, 201, 212, 0.1);
            border: 3px solid var(--primary-color);
            border-radius: 20px;
            display: inline-block;
            perspective: 1000px;
            transition: all 0.1s ease-out;
            transform-style: preserve-3d;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 201, 212, 0.2);
        }

        .badge-container:hover {
            box-shadow: 0 20px 50px rgba(255, 201, 212, 0.4);
        }

        .badge-content {
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
        }

        .badge-icon {
            font-size: 6em;
            margin-bottom: 20px;
            animation: badgeFloat 2s ease-in-out infinite;
        }

        @keyframes badgeFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .badge-title {
            font-size: 2em;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-light), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .badge-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2em;
        }

        .results-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 50px;
            flex-wrap: wrap;
        }

        .btn-share {
            padding: 20px 50px;
            background: linear-gradient(135deg, #1DA1F2, #0d8bd9);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 12px;
        }

        .btn-share:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(29, 161, 242, 0.4);
        }

        .btn-restart {
            padding: 20px 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-restart:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 201, 212, 0.5);
        }

        @media (max-width: 768px) {
            .quiz-hero h1 { font-size: 2.5em; }
            .quiz-hero p { font-size: 1.1em; }
            .quiz-card { padding: 25px; }
            .quiz-question { font-size: 1.3em; }
            .score-display { font-size: 5em; }
            .badge-icon { font-size: 4em; }
            .results-actions { flex-direction: column; }
            .btn-share, .btn-restart { width: 100%; justify-content: center; }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar sticky-nav" id="navbar" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <div class="logo">
                <a href="index.html" class="logo-link" aria-label="Hippocamp Academy Home">
                    <img src="Hippocamp logo.png" alt="Hippocamp Academy" class="logo-icon">
                    <span>HIPPOCAMP<span class="logo-sub">academy</span></span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links" id="navLinks" role="menubar">
                <li role="none"><a href="index.html#home" class="nav-link" role="menuitem">Home</a></li>
                <li role="none" class="story-menu-item"><a href="#" class="nav-link story-rewatch" role="menuitem" onclick="triggerGensynStory(); return false;"><i class="fas fa-book-open"></i> Story</a></li>
                <li role="none"><a href="index.html#node-setup" class="nav-link nav-highlight" role="menuitem">Deploy Node</a></li>
                <li role="none"><a href="index.html#applications" class="nav-link" role="menuitem">Applications</a></li>
                <li role="none"><a href="code-playground.html" class="nav-link active" role="menuitem">Playground</a></li>
                <li role="none"><a href="index.html#research" class="nav-link" role="menuitem">Research</a></li>
                <li role="none"><a href="index.html#community" class="nav-link" role="menuitem">Community</a></li>
            </ul>
        </div>
    </nav>

    <div class="quiz-hero">
        <h1>üß† Gensyn Knowledge Quiz</h1>
        <p>Test your understanding of the Gensyn protocol and earn your badge!</p>
    </div>

    <div class="quiz-container">
        <!-- Quiz Progress -->
        <div class="quiz-progress">
            <div class="progress-text">Question <span id="currentQ">1</span> of 12</div>
            <div class="progress-bar-container">
                <div class="progress-fill" id="progressBar" style="width: 8.33%"></div>
            </div>
        </div>

        <!-- Quiz Card -->
        <div class="quiz-card" id="quizCard">
            <!-- Questions will be dynamically inserted here -->
        </div>

        <!-- Results Screen -->
        <div class="results-screen" id="resultsScreen">
            <h2 class="results-title">Quiz Complete! üéâ</h2>
            <div class="score-display" id="scoreDisplay"></div>
            <div class="score-message" id="scoreMessage"></div>
            
            <div class="badge-container" id="badgeContainer" style="display: none;">
                <div class="badge-icon" id="badgeIcon"></div>
                <div class="badge-title" id="badgeTitle"></div>
                <div class="badge-subtitle" id="badgeSubtitle"></div>
            </div>

            <div class="results-actions">
                <button class="btn-share" onclick="shareOnX()">
                    <i class="fab fa-twitter"></i> Share on X
                </button>
                <button class="btn-restart" onclick="restartQuiz()">
                    <i class="fas fa-redo"></i> Retake Quiz
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        const quizData = [
            {
                question: "What is Gensyn's primary purpose?",
                options: [
                    "A cryptocurrency exchange platform",
                    "A decentralized compute protocol for machine learning",
                    "A social media platform for AI researchers",
                    "A centralized cloud computing service"
                ],
                correct: 1,
                difficulty: "easy",
                explanation: "Gensyn is a decentralized protocol that creates a global marketplace for machine learning computation, connecting anyone with compute power to developers who need it for AI training."
            },
            {
                question: "What does RL Swarm stand for?",
                options: [
                    "Real-time Learning System for Web Applications and Machine",
                    "Reinforcement Learning Swarm",
                    "Remote Learning Software with Advanced Routing and Monitoring",
                    "Resilient Logic System with Adaptive Resource Management"
                ],
                correct: 1,
                difficulty: "easy",
                explanation: "RL Swarm is Reinforcement Learning Swarm - a peer-to-peer system where multiple AI models train collaboratively, sharing insights and learning from collective experiences."
            },
            {
                question: "What is the main advantage of decentralized AI training?",
                options: [
                    "It requires more expensive hardware",
                    "It makes AI training slower and less efficient",
                    "It democratizes access to compute power and reduces costs",
                    "It increases centralization of AI development"
                ],
                correct: 2,
                difficulty: "easy",
                explanation: "Decentralized AI training democratizes access to compute resources, making ML infrastructure accessible and affordable for everyone, not just big tech companies."
            },
            {
                question: "What role does the Judge system play in Gensyn?",
                options: [
                    "It manages user accounts and permissions",
                    "It verifies computation integrity and ensures consensus",
                    "It processes cryptocurrency transactions",
                    "It moderates community forums"
                ],
                correct: 1,
                difficulty: "medium",
                explanation: "Judge is an autonomous model verification system that runs automatically with RL Swarm nodes to ensure computation integrity and consensus in a trustless manner."
            },
            {
                question: "What is the minimum RAM requirement for running a CPU-only node?",
                options: [
                    "8GB RAM",
                    "16GB RAM",
                    "32GB RAM",
                    "64GB RAM"
                ],
                correct: 2,
                difficulty: "easy",
                explanation: "To run a Gensyn node with CPU only, you need a minimum of 32GB RAM. GPU nodes require 8GB+ VRAM."
            },
            {
                question: "What is BlockAssist?",
                options: [
                    "A blockchain explorer",
                    "An AI-powered Minecraft assistant using reinforcement learning",
                    "A cryptocurrency wallet",
                    "A block validation service"
                ],
                correct: 1,
                difficulty: "medium",
                explanation: "BlockAssist is an AI Minecraft assistant that learns from human actions, demonstrating reinforcement learning in interactive gaming environments."
            },
            {
                question: "How many nodes are currently active on the Gensyn testnet?",
                options: [
                    "Around 1,000 nodes",
                    "Around 5,000 nodes",
                    "Over 12,000 nodes",
                    "Around 50,000 nodes"
                ],
                correct: 2,
                difficulty: "easy",
                explanation: "Gensyn's testnet has grown to over 12,000 active nodes, demonstrating strong community participation and network growth."
            },
            {
                question: "What is the purpose of SAPO in the Gensyn ecosystem?",
                options: [
                    "It's a token staking mechanism",
                    "It's a meta-algorithm for efficient LM post-training with collective RL",
                    "It's a data storage protocol",
                    "It's a consensus mechanism"
                ],
                correct: 1,
                difficulty: "medium",
                explanation: "SAPO (Selective Activation of Policy Optimization) is a meta-algorithm that wraps around policy gradient algorithms for more efficient language model post-training using collective reinforcement learning."
            },
            {
                question: "What does CheckFree solve in distributed training?",
                options: [
                    "Payment processing for compute resources",
                    "Fault tolerance without checkpointing or redundant computation",
                    "Free compute credits for users",
                    "Automated check-ins for node operators"
                ],
                correct: 1,
                difficulty: "medium",
                explanation: "CheckFree is a novel recovery method for distributed training failures that achieves fault tolerance without requiring checkpointing or redundant computation, making distributed training more efficient."
            },
            {
                question: "What is the key innovation of NoLoCo?",
                options: [
                    "Training large models without all-reduce operations",
                    "A new consensus algorithm for blockchains",
                    "Localized compute resource allocation",
                    "No-login access to compute resources"
                ],
                correct: 0,
                difficulty: "hard",
                explanation: "NoLoCo replaces global synchronization (all-reduce) with a gossip method for distributed training, enabling more efficient training of large models in heterogeneous, decentralized networks where traditional all-reduce would be a bottleneck."
            },
            {
                question: "How does SkipPipe improve communication efficiency in decentralized training?",
                options: [
                    "By compressing all data transfers",
                    "By using pipeline parallelism with strategic skipping of certain communications",
                    "By caching frequently accessed data locally",
                    "By reducing the number of training epochs"
                ],
                correct: 1,
                difficulty: "hard",
                explanation: "SkipPipe uses pipeline parallelism with strategic skipping of certain communication steps, significantly reducing bandwidth requirements in heterogeneous networks while maintaining model quality. This is crucial for making decentralized training practical in networks with varying connection speeds."
            },
            {
                question: "What verification approach does Verde use to ensure ML computation correctness?",
                options: [
                    "Re-running all computations on trusted nodes",
                    "Probabilistic verification using statistical sampling and cryptographic proofs",
                    "Majority voting among all network participants",
                    "Comparing outputs with pre-computed reference values"
                ],
                correct: 1,
                difficulty: "hard",
                explanation: "Verde employs probabilistic verification using statistical sampling combined with cryptographic proofs to verify ML computations are done correctly over untrusted nodes. This approach is orders of magnitude more efficient than re-computation while still providing strong guarantees, making it practical for large-scale decentralized ML training."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        function renderQuestion() {
            const q = quizData[currentQuestion];
            const card = document.getElementById('quizCard');
            
            const difficultyClass = `difficulty-${q.difficulty}`;
            
            card.innerHTML = `
                <span class="${difficultyClass} difficulty-badge">${q.difficulty}</span>
                <div class="quiz-question">${q.question}</div>
                <div class="quiz-options">
                    ${q.options.map((option, index) => `
                        <div class="quiz-option" onclick="selectAnswer(${index})">
                            ${option}
                        </div>
                    `).join('')}
                </div>
                <div class="quiz-explanation" id="explanation">${q.explanation}</div>
                <div class="quiz-actions">
                    <button class="btn-quiz btn-next" id="nextBtn" onclick="nextQuestion()" disabled>
                        ${currentQuestion < quizData.length - 1 ? 'Next Question' : 'View Results'} <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            `;

            document.getElementById('currentQ').textContent = currentQuestion + 1;
            document.getElementById('progressBar').style.width = `${((currentQuestion + 1) / quizData.length) * 100}%`;
            
            answered = false;
        }

        function selectAnswer(selected) {
            if (answered) return;
            
            answered = true;
            const q = quizData[currentQuestion];
            const options = document.querySelectorAll('.quiz-option');
            
            options[selected].classList.add('selected');
            
            setTimeout(() => {
                options.forEach((option, index) => {
                    if (index === q.correct) {
                        option.classList.add('correct');
                    } else if (index === selected) {
                        option.classList.add('incorrect');
                    }
                    option.style.pointerEvents = 'none';
                });

                if (selected === q.correct) {
                    score++;
                }

                document.getElementById('explanation').classList.add('show');
                document.getElementById('nextBtn').disabled = false;
            }, 300);
        }

        function nextQuestion() {
            if (!answered) return;
            
            currentQuestion++;
            
            if (currentQuestion < quizData.length) {
                renderQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quizCard').style.display = 'none';
            document.querySelector('.quiz-progress').style.display = 'none';
            
            const resultsScreen = document.getElementById('resultsScreen');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const scoreMessage = document.getElementById('scoreMessage');
            const badgeContainer = document.getElementById('badgeContainer');
            const badgeIcon = document.getElementById('badgeIcon');
            const badgeTitle = document.getElementById('badgeTitle');
            const badgeSubtitle = document.getElementById('badgeSubtitle');
            
            resultsScreen.classList.add('show');
            scoreDisplay.textContent = `${score}/12`;
            
            let message = '';
            let badge = null;
            
            if (score === 12) {
                message = "Perfect Score! You're a Gensyn Master! üåü";
                badge = {
                    icon: 'üëë',
                    title: 'Master',
                    subtitle: 'Perfect Score - Elite Level'
                };
            } else if (score >= 10) {
                message = "Excellent! You're a Gensyn Pioneer! üéØ";
                badge = {
                    icon: 'üèÜ',
                    title: 'Pioneer',
                    subtitle: 'Outstanding Knowledge'
                };
            } else if (score >= 8) {
                message = "Great job! You're a Gensyn Explorer! üí™";
                badge = {
                    icon: '‚≠ê',
                    title: 'Explorer',
                    subtitle: 'Strong Understanding'
                };
            } else if (score >= 6) {
                message = "Good effort! Keep learning, Rover! üìö";
                badge = {
                    icon: 'ü¶õ',
                    title: 'Rover',
                    subtitle: 'Building Knowledge'
                };
            } else {
                message = "Keep studying! Every hippo starts somewhere! ü¶õ";
            }
            
            scoreMessage.textContent = message;
            
            if (badge) {
                badgeContainer.style.display = 'inline-block';
                badgeIcon.textContent = badge.icon;
                badgeTitle.textContent = badge.title;
                badgeSubtitle.textContent = badge.subtitle;
                
                // Add 3D tilt effect to badge container
                add3DTiltEffect(badgeContainer);
            }
            
            // Add 3D tilt effect to score display
            add3DTiltEffect(scoreDisplay);
        }

        // 3D Tilt Effect Function
        function add3DTiltEffect(element) {
            element.addEventListener('mousemove', (e) => {
                const rect = element.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const rotateX = ((y - centerY) / centerY) * -10; // Max 10deg tilt
                const rotateY = ((x - centerX) / centerX) * 10;
                
                element.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
            });
            
            element.addEventListener('mouseleave', () => {
                element.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg)';
            });
        }

        async function generateScoreCard() {
            // Create canvas with Twitter card dimensions
            const canvas = document.createElement('canvas');
            canvas.width = 1200;
            canvas.height = 630;
            const ctx = canvas.getContext('2d');

            // Determine rank based on score
            const getRank = (score) => {
                if (score === 12) return { title: "Master", color: "#FFB6D9", emoji: "üëë" };
                if (score >= 10) return { title: "Pioneer", color: "#FFC8E0", emoji: "üèÜ" };
                if (score >= 8) return { title: "Explorer", color: "#FFD6DE", emoji: "‚≠ê" };
                return { title: "Rover", color: "#FFE0E8", emoji: "ü¶õ" };
            };
            
            const rank = getRank(score);
            const percentage = Math.round((score / 12) * 100);

            return new Promise((resolve, reject) => {
                // Create gradient background
                const bgGradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                bgGradient.addColorStop(0, '#0a0e27');
                bgGradient.addColorStop(0.5, '#1a1f3a');
                bgGradient.addColorStop(1, '#0a0e27');
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Add decorative elements
                ctx.strokeStyle = 'rgba(255, 182, 217, 0.15)';
                ctx.lineWidth = 2;
                
                // Draw circuit-like lines
                for (let i = 0; i < 8; i++) {
                    ctx.beginPath();
                    const startX = Math.random() * canvas.width;
                    const startY = Math.random() * canvas.height;
                    ctx.moveTo(startX, startY);
                    ctx.lineTo(startX + (Math.random() * 200 - 100), startY + (Math.random() * 200 - 100));
                    ctx.stroke();
                }

                // Draw node circles
                for (let i = 0; i < 15; i++) {
                    ctx.beginPath();
                    ctx.arc(
                        Math.random() * canvas.width,
                        Math.random() * canvas.height,
                        Math.random() * 3 + 1,
                        0,
                        Math.PI * 2
                    );
                    ctx.fillStyle = `rgba(255, 182, 217, ${Math.random() * 0.3 + 0.1})`;
                    ctx.fill();
                }

                // Draw main card container
                const cardX = 100;
                const cardY = 80;
                const cardWidth = canvas.width - 200;
                const cardHeight = canvas.height - 160;
                const cornerRadius = 30;

                // Card background with gradient
                const cardGradient = ctx.createLinearGradient(cardX, cardY, cardX, cardY + cardHeight);
                cardGradient.addColorStop(0, 'rgba(26, 31, 58, 0.95)');
                cardGradient.addColorStop(1, 'rgba(15, 20, 40, 0.95)');
                
                ctx.fillStyle = cardGradient;
                ctx.beginPath();
                ctx.roundRect(cardX, cardY, cardWidth, cardHeight, cornerRadius);
                ctx.fill();

                // Card border with glow
                ctx.strokeStyle = rank.color;
                ctx.lineWidth = 3;
                ctx.shadowBlur = 20;
                ctx.shadowColor = rank.color;
                ctx.stroke();
                ctx.shadowBlur = 0;

                // Top section - Gensyn Logo text
                ctx.font = 'bold 32px Inter, sans-serif';
                ctx.fillStyle = '#FFB6D9';
                ctx.textAlign = 'center';
                ctx.fillText('GENSYN', canvas.width / 2, cardY + 60);

                // Subtitle
                ctx.font = '20px Inter, sans-serif';
                ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                ctx.fillText('Knowledge Quiz', canvas.width / 2, cardY + 95);

                // Main score display
                ctx.font = 'bold 140px Inter, sans-serif';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // Score gradient
                const scoreGradient = ctx.createLinearGradient(
                    canvas.width / 2 - 150, 
                    canvas.height / 2 - 50, 
                    canvas.width / 2 + 150, 
                    canvas.height / 2 + 50
                );
                scoreGradient.addColorStop(0, '#FFD6DE');
                scoreGradient.addColorStop(0.5, '#FFAFBF');
                scoreGradient.addColorStop(1, '#FF8FA3');
                
                ctx.fillStyle = scoreGradient;
                ctx.shadowBlur = 30;
                ctx.shadowColor = rank.color;
                ctx.fillText(`${score}/12`, canvas.width / 2, canvas.height / 2 - 10);
                ctx.shadowBlur = 0;

                // Percentage text
                ctx.font = 'bold 24px Inter, sans-serif';
                ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                ctx.fillText(`${percentage}% COMPLETE`, canvas.width / 2, canvas.height / 2 + 80);

                // Rank badge
                const badgeY = canvas.height / 2 + 130;
                const badgeWidth = 250;
                const badgeHeight = 50;
                const badgeX = canvas.width / 2 - badgeWidth / 2;

                // Badge background
                const badgeGradient = ctx.createLinearGradient(badgeX, badgeY, badgeX + badgeWidth, badgeY);
                badgeGradient.addColorStop(0, `${rank.color}20`);
                badgeGradient.addColorStop(0.5, `${rank.color}40`);
                badgeGradient.addColorStop(1, `${rank.color}20`);
                
                ctx.fillStyle = badgeGradient;
                ctx.beginPath();
                ctx.roundRect(badgeX, badgeY, badgeWidth, badgeHeight, 25);
                ctx.fill();

                // Badge border
                ctx.strokeStyle = rank.color;
                ctx.lineWidth = 2;
                ctx.stroke();

                // Badge text
                ctx.font = 'bold 28px Inter, sans-serif';
                ctx.fillStyle = '#FFFFFF';
                ctx.textAlign = 'center';
                ctx.fillText(`${rank.emoji} ${rank.title.toUpperCase()}`, canvas.width / 2, badgeY + 33);

                // Bottom branding
                ctx.font = '18px Inter, sans-serif';
                ctx.fillStyle = 'rgba(255, 182, 217, 0.6)';
                ctx.fillText('Hippocamp Academy ü¶õ', canvas.width / 2, cardY + cardHeight - 30);

                // Decorative corner elements
                ctx.strokeStyle = rank.color;
                ctx.lineWidth = 3;
                
                // Top left corner
                ctx.beginPath();
                ctx.moveTo(cardX + 40, cardY + 20);
                ctx.lineTo(cardX + 20, cardY + 20);
                ctx.lineTo(cardX + 20, cardY + 40);
                ctx.stroke();

                // Top right corner
                ctx.beginPath();
                ctx.moveTo(cardX + cardWidth - 40, cardY + 20);
                ctx.lineTo(cardX + cardWidth - 20, cardY + 20);
                ctx.lineTo(cardX + cardWidth - 20, cardY + 40);
                ctx.stroke();

                // Bottom left corner
                ctx.beginPath();
                ctx.moveTo(cardX + 20, cardY + cardHeight - 40);
                ctx.lineTo(cardX + 20, cardY + cardHeight - 20);
                ctx.lineTo(cardX + 40, cardY + cardHeight - 20);
                ctx.stroke();

                // Bottom right corner
                ctx.beginPath();
                ctx.moveTo(cardX + cardWidth - 20, cardY + cardHeight - 40);
                ctx.lineTo(cardX + cardWidth - 20, cardY + cardHeight - 20);
                ctx.lineTo(cardX + cardWidth - 40, cardY + cardHeight - 20);
                ctx.stroke();

                // Convert canvas to blob
                canvas.toBlob((blob) => {
                    resolve(blob);
                }, 'image/png');
            });
        }

        async function shareOnX() {
            try {
                // Show loading state on button
                const shareBtn = event.target.closest('.btn-share');
                const originalText = shareBtn.innerHTML;
                shareBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
                shareBtn.disabled = true;
                
                // Generate the score card image
                const imageBlob = await generateScoreCard();
                
                // Create a temporary URL for the image
                const imageUrl = URL.createObjectURL(imageBlob);
                
                // Determine rank for tweet text
                const getRankForTweet = (score) => {
                    if (score === 12) return { title: "Master", emoji: "üëë" };
                    if (score >= 10) return { title: "Pioneer", emoji: "üèÜ" };
                    if (score >= 8) return { title: "Explorer", emoji: "‚≠ê" };
                    return { title: "Rover", emoji: "ü¶õ" };
                };
                
                const rank = getRankForTweet(score);
                const scoreText = score === 12 ? 'PERFECT SCORE' : `${score}/12`;
                
                const text = `I just scored ${scoreText} on the @gensyn_ai Knowledge Quiz! ${rank.emoji} ${rank.title}\n\nThink you can beat my score? Test your knowledge at Hippocamp Academy! ü¶õ\n\n#Gensyn #DecentralizedAI #Web3`;
                const url = 'https://hippocamp-gensyn.vercel.app/code-playground.html';
                
                // Check if Web Share API is available (mobile with file support)
                if (navigator.share && navigator.canShare) {
                    try {
                        const file = new File([imageBlob], 'gensyn-quiz-score.png', { type: 'image/png' });
                        if (navigator.canShare({ files: [file] })) {
                            await navigator.share({
                                title: 'My Gensyn Quiz Score',
                                text: text,
                                files: [file],
                                url: url
                            });
                            shareBtn.innerHTML = originalText;
                            shareBtn.disabled = false;
                            return;
                        }
                    } catch (shareError) {
                        console.log('Web Share API not fully supported, using fallback');
                    }
                }
                
                // Desktop/fallback: Download image and open Twitter
                shareBtn.innerHTML = '<i class="fas fa-download"></i> Downloading image...';
                
                const link = document.createElement('a');
                link.download = 'gensyn-quiz-score.png';
                link.href = imageUrl;
                link.click();
                
                // Show instruction message
                setTimeout(() => {
                    shareBtn.innerHTML = '<i class="fas fa-check"></i> Opening X...';
                    
                    // Open Twitter compose with pre-filled text and instruction to attach downloaded image
                    setTimeout(() => {
                        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text + '\n\nüì∏ Attach your downloaded score card image!')}&url=${encodeURIComponent(url)}`;
                        window.open(twitterUrl, '_blank', 'width=550,height=420');
                        
                        // Reset button
                        setTimeout(() => {
                            shareBtn.innerHTML = originalText;
                            shareBtn.disabled = false;
                        }, 1500);
                    }, 800);
                }, 500);
                
                // Clean up blob URL
                setTimeout(() => URL.revokeObjectURL(imageUrl), 15000);
                
            } catch (error) {
                console.error('Error generating score card:', error);
                
                // Reset button
                const shareBtn = event.target.closest('.btn-share');
                shareBtn.innerHTML = '<i class="fab fa-twitter"></i> Share on X';
                shareBtn.disabled = false;
                
                // Fallback to text-only tweet
                const getRankForTweet = (score) => {
                    if (score === 12) return { title: "Master", emoji: "üëë" };
                    if (score >= 10) return { title: "Pioneer", emoji: "üèÜ" };
                    if (score >= 8) return { title: "Explorer", emoji: "‚≠ê" };
                    return { title: "Rover", emoji: "ü¶õ" };
                };
                
                const rank = getRankForTweet(score);
                const scoreText = score === 12 ? 'PERFECT SCORE' : `${score}/12`;
                
                const text = `I just scored ${scoreText} on the @gensyn_ai Knowledge Quiz! ${rank.emoji} ${rank.title}\n\nThink you can beat my score? ü¶õ\n\n#Gensyn #DecentralizedAI #Web3`;
                const url = 'https://hippocamp-gensyn.vercel.app/code-playground.html';
                const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
                
                window.open(twitterUrl, '_blank', 'width=550,height=420');
            }
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            answered = false;
            
            document.getElementById('resultsScreen').classList.remove('show');
            document.getElementById('quizCard').style.display = 'block';
            document.querySelector('.quiz-progress').style.display = 'block';
            
            renderQuestion();
        }

        // Initialize quiz on load
        document.addEventListener('DOMContentLoaded', () => {
            renderQuestion();
        });
    </script>
</body>
</html>
